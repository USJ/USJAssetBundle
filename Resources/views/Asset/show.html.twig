{% extends 'MDBAssetBundle::layout.html.twig' %}

{% block page_header %}
	&nbsp;
	<ul class="breadcrumb">
		<li><a href="{{ path('mdb_asset_asset_index') }}">Assets</a><span class="divider">/</span></li>
		{% set asset_path = asset.path|split("|") %}
		{% for item in asset_path %}
			{% set referenceId = item|slice(0,-25) %}
			{% set id = item|slice(-24) %}

			{% if referenceId == asset.referenceId %}
				<li class="active">{{ referenceId }}</li>
			{% else %}
				<li><a href="{{ path('mdb_asset_asset_show', {'id' : id }) }}">{{ referenceId }}</a><span class="divider">/</span></li>
			{% endif %}
		{% endfor %}
	</ul>
{% endblock %}

{% block content %}
	<input type="hidden" id="asset_id" value="{{ asset.id }}" />
	<input type="hidden" id="asset_class" value="{{ asset.class }}" />

	<h1 class="span12">{{ asset.name }}</h1>
	<div class="span12">
		{{ asset.description }}
	</div>
	<div class="span4" id="asset_property">
		<legend class="simple">Manufacturer Properties</legend>
		<table class="table">
			<tbody>
				{% for property in asset.properties %}
					<tr>
						<td>{{property.name}}</td>
						<td>{{property.value}}</td>
						<td>
							<form action="{{ path('mdb_asset_asset_properties_delete', {"id": asset.id })}}" method="post">
								<input type="hidden" name="_method" value="DELETE" />
								<input type="hidden" name="property_name" value="{{property.name}}" />
								<input type="hidden" name="property_value" value="{{property.value}}" />
								<input class="btn" type="submit" value="Delete">
							</form>
						</td>
					</tr>
				{% endfor %}
				<tr>
					<form action="{{ path('mdb_asset_asset_properties', {"id": asset.id }) }}" method="post">
					<td><input type="text" class="input-small" id="new_prop_name" name="property_name" /></td>
					<td><input type="text" class="input-small" id="new_prop_value" name="property_value" /></td>
					<td><input class="btn" type="submit" value="Add"></td>
					</form>
				</tr>
			</tbody>
		</table>
	</div>
	<div class="span4">
		<legend class="simple">Operational Report</legend>
	</div>
	<div class="span12">
		<ul class="nav nav-tabs">
			<li class="active">
				<a href="#documents" data-toggle="tab">Documents <span class="badge">
					{% render 'MDBDocumentBundle:Partial:renderCount' with {'linkObject': asset } %}
				</span></a>
			</li>
	    	<li>
	    		<a href="#asset" data-toggle="tab">Assets <span class="badge">4</span></a>
	    	</li>
	    	<li>
	    		<a href="#workorder" data-toggle="tab">Work Orders <span class="badge">3</span></a>
	    	</li>
	    	<li>
	    		<a href="#sensor" data-toggle="tab">Sensors <span class="badge">4</span></a>
	    	</li>
	    </ul>
	    <div class="tab-content">
	    	<div id="documents" class="tab-pane active">
				<button class="btn btn-small" data-target="#doc-create" data-toggle="modal"><i class="icon-plus"></i> Add a Document</button>

				{% render 'MDBDocumentBundle:Partial:renderIndex'  with {'linkObject': asset } %}
			</div>
	    	<div id="asset" class="tab-pane"></div>
	    	<div id="workorder" class="tab-pane"></div>
	    	<div id="sensor" class="tab-pane">
	    		Coming soon
	    	</div>

	    </div>
	</div>

	{% render 'MDBDocumentBundle:Partial:renderUploadBox'  with {'linkObject': asset } %}
{% endblock %}